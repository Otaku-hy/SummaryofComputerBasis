1. 局部性原理：

   程序具有空间/时间局部性：即访问过的内容(数据代码)可能在以后还会被访问，访问过的内容的周围的内容很可能也会被访问到

2. 缓存cache：小而快速的存储设备，作为内存中数据的缓冲

3. why缓存：CPU速度快，memory访问速度慢，为了提高处理速度，在M和CPU间设计了cache

4. 结构：整个cache被分为多个高速缓存组共S=2^s^-1个，每一个组又由多个高速缓存行cache line共E个组成，每个cache line包含：一个valid位表示数据是否有效，一组标记位用于匹配，一个B=2^b^字节的数据块

   访问cache(地址划分)：

   |t位—group中找line|s位—找group|b位—找字节 |

​	以地址中间部分作为组号可以使地址接近的数据映射到不同组内，减少相互的竞争，局部性更好

5. 写相关问题：

   1. 向缓存中写入数据后何时更新下层数据？

      a. 直写：立即写到内存

      b. 写回：等到该块被换出时才写到内存，需要在cache line中引入	dirty位判断是否要写

   2. 需要写数据时缓存不命中？

      a. 写分配：将数据加载到缓存，并写入缓存

      b. 非写分配：直接写到内存

6. 缓存一致性问题？

   1. 多级缓存的缓存一致性：不同层级的存取器中对于一个数据的副本不一致的问题：见5

   2. 多核系统的缓存一致性：由于每个核有自己的寄存器和缓存，当多个核对一个全局变量都进行操作时，这些寄存器和缓存中的数据不一致导致操作非预期

      解决：使用volatile关键字防止变量暂存寄存器，总线中加锁，采用缓存一致性协议

