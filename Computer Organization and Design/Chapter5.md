## 数据的表示与运算

### 1. 数值数据的表示

1. 无符号数：机器字长n位全部用于表示数值：0~2^n^-1

2. 有符号数：考虑安排最高位表示符号

   a. 定点整数—小数点隐含在最后一位后

   ​	原码：符号位0正1负，数值位为真值的绝对值 范围-(2^n-1^-1)~(2^n-1^-1)

   ​	反码：负数用绝对值的原码按位取反表示 范围 -(2^n-1^-1)~(2^n-1^-1)

   ​	补码：负数用绝对值的原码按位取反再+1表示 范围 -2^n-1^~(2^n-1^-1)

   ​	移码：补码的符号位取反 范围 -2^n-1^~(2^n-1^-1) (适用于作为浮点数的阶码用于比较大小)

   b. 定点小数—小数点隐含在符号位后

   ​	原码/反码：-(1-2^-(n-1)^)~(1-2^-(n-1)^)

​		补码：-1~(1-2^-(n-1)^)

### 2. 简单运算与加法器设计

1. 加法：加法运算使用补码进行运算

   **溢出判断：使用双符号位：正数00，负数11，当结果10,01时溢出

2. 移位：

   逻辑移位：移除位直接丢弃，并补零

   算数移位：原码：符号位不动，其他同逻辑

   ​		    反码：符号位不动，正则补0，负则补1

   ​		    补码：左移补0，右移根据符号位补

   ​	**舍入：舍0入1—根据丢弃的最高位决定是否+1

3. 并行加法器：

   串行进位：c~i+1~ = x~i~y~i~ + x~i~ $\bigoplus$ y~i~c~i~ 取g~i~ = x~i~y~i~, p~i~=x~i~$\bigoplus$y~i~  则c~i+!~ = g~i~ + p~i~c~i~

   于是，每一位的c都依赖前一位的c的结果，所以逐级相连可以串行：<img src="./images/截屏2023-12-30 18.51.52.png" alt="截屏2023-12-30 18.51.52" style="zoom:25%;" />

​	将c~i+1~中的c~i~项展开：
$$
c_{i+1} = &g_i + p_ic_i \\
c_{i+2} = &g_{i+1} + p_{i+1}g_i + p_{i+1}p_ic_i \\
c_{i+3} = &g_{i+2} + p_{i+2}g_{i+1} +p_{i+2}p_{i+1}g_i + p_{i+2}p_{i+1}p_ic_i \\
c_{i+4} = &g_{i+3} + p_{i+3}g_{i+2} + p_{i+3}p_{i+2}g_{i+1} +p_{i+3}p_{i+2}p_{i+1}g_i + p_{i+3}p_{i+2}p_{i+1}p_ic_i \\
$$
​	  因此我们可以一次算出所有的进位信息：

​	<img src="./images/截屏2023-12-30 19.00.14.png" alt="截屏2023-12-30 19.00.14" style="zoom:25%;" />

​	因此可以在第一层生成g，p；第二层算出所有进位；第三次再计算加结果

​	大于四位时考虑多级多个CLA相连

​	成组先行-级联进位：

​	将四位划为一组后每一组需要前一组提供的进位信息才能计算进位，所以串连：

​	<img src="./images/截屏2023-12-30 19.07.01.png" alt="截屏2023-12-30 19.07.01" style="zoom:25%;" />	

​	但是太耗时，将组间传递的进位信息简化表示：
$$
c_{i+4} &= g_{i+3} + p_{i+3}g_{i+2} + p_{i+3}p_{i+2}g_{i+1} +p_{i+3}p_{i+2}p_{i+1}g_i + p_{i+3}p_{i+2}p_{i+1}p_ic_i \\
&= G_i + P_ic_i
$$
所以对于所有组间进位信息，我们展开表示：
$$
c_{4} = &G_0 + P_0c_0 \\
c_{8} = &G_{1} + P_{1}G_0 + P_{1}P_0c_0 \\
c_{12} = &G_{2} + P_{2}G_{1} +P_{2}P_{1}G_0 + P_{2}P_{1}P_0c_0 \\
c_{16} = &G_{3} + P_{3}G_{2} + P_{3}P_{2}G_{1} +P_{3}P_{2}P_{1}G_i + P_{3}P_{2}P_{1}P_ic_i \\
$$
于是这些进位信息我们可以一次算出，并传递给下层需要组间进位信息的CLA中：<img src="./images/截屏2023-12-30 19.16.37.png" alt="截屏2023-12-30 19.16.37" style="zoom:25%;" />

先算p，g，再算P，G和C0\~3,再算C4,8,12,16,最后算c5\~7,c9~11

据此，我们可以给出使用74181,74182构成的64位三级先行进位ALU：

<img src="./images/截屏2023-12-30 19.19.45.png" alt="截屏2023-12-30 19.19.45" style="zoom:25%;" />