1. I/O设备的分类

   a. 块设备：与其他设备间的数据传输通过一个块传输，其数据可进行寻址

   b. 字符设备：与其他设备间的数据传输通过字节传输，一次只能传输一个字节，不可寻址

2. IO硬件：端口，总线，IO控制器

3. IO控制器：可以操作设备，端口，总线的设备

   组成：CPU与控制器间的接口——实现CPU和控制器通讯；

   ​		包括 ：数据寄存器(输入和输出)，状态寄存器，控制寄存器(存放指令和参数)

   ​	    IO逻辑 ——识别CPU命令并向设备发出命令；

   ​	    控制器与设备间的端口——实现控制器与设备通讯；

   **注：如何访问控制器IO接口的寄存器？当IO独立编址时需要使用单独的指令，当IO与内存同一编址时则可以直接内存映射IO，使用相同的指令

4. IO控制方式：

   a. 轮询(程序直接控制): CPU发出IO指令后并不断从状态寄存器取值判断设备是否准备数据

   ​	profile : CPU干预频率极高，IO以字为单位，数据经过CPU

   b. 中断: CPU发出IO指令后执行其他进程，并等待控制器向CPU发出中断信号再继续执行

​		profile : CPU干预频率高，IO以字为单位，数据经过CPU

​	**注：对于单任务系统，内核态保存用户数据，并在中断返回时恢复数据

​		    对于多任务系统，用户数据保存到PCB，并在中断返回时恢复一Ready进程的PCB

​	c. DMA: CPU发出IO指令后执行其他进程，由DMA控制器完成大量数据的IO，并发送中断

​		profile：CPU干预频率低，IO以块为单位，数据不经过CPU

​	d. 通道控制：通道为专门处理IO的协处理单元，比DMA更能支持离散块的IO

​		profile：CPU干预频率低，IO以多个块为单位，数据不经过CPU

5. IO应用框架：

   软件部分：用户层 ->内核 -> 内核IO子系统 -> 设备驱动程序(隐藏不同IO控制器间的差异，为内核提供标准的接口的程序) -> 中断处理程序

   硬件部分：IO控制器 -> IO设备

6. IO应用接口：

   字符设备接口：get/put系统调用读写字符

   块设备接口：read/write系统调用

   网络设备接口：socket

7. 阻塞与异步IO：

   阻塞：进程发出IO请求后变等待态

   异步：发出IO请求后系统调用立即返回，无需等待

8. 内核IO子系统功能：

   a. IO调度：确定IO顺序以减少平均等待时间

   b. 缓冲：使用内存区域保存在设备间传输的数据

   ​	原因：数据的生产者消费者速度不匹配；协调传输数据大小不一致的设备；支持复制			语义

   ​	方式：单缓冲，双缓冲，循环缓冲，缓冲池

   c. 设备分配：

   ​	数据结构：

   ​		设备控制表DCT：内容—类型/标识符/状态/指向COCT的指针/等待队列指针

   ​		控制器控制表COCT：内容—状态/指向CHCT的指针/等待队列指针

   ​		通道控制表CHCT：内容—状态/等待队列指针

   ​		系统设备表SDT：每个条目内容—设备类型/标识符/DCT/驱动程序入口

   ​		LUT：实现逻辑设备名到物理设备名的映射

   ​	分配步骤：1有逻辑设备名查找LUT得到设备类型 -> 2在SDT中寻找相应的设备的DCF				并分配设备 -> 3 根据DCT找到COCT并分配控制器 -> 4 根据COCT找到				CHCT并分配通道

   d. 假脱机(spooling)技术：模拟脱机I/O的技术

   ​	输入输出井(磁盘上)—模拟脱机输入的磁带

   ​	输入输出进程—模拟外围控制机

   ​	输入输出缓冲—内存中的缓冲区，中转数据

   ​	**通过假脱机可实现独占设备的共享

   e. IO保护：所有IO指令为特权指令；IO端口内存位置拒绝用户访问

   ​	



